<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="ipsStatus">

	<select id="selectStatusReqInfo" parameterType = "hashmap" resultType="hashmap">
		SELECT 
            DISTINCT DCM.DEV_TYPE AS CLI_DEV_TYPE,
            DSI.OPERATE_FORMAT,
			U.HTTP_METHOD, 
			U.HEADER_V, 
			U.CONT_TYPE, 
			U.CHANNEL_CD, 
			U.SERVICE_CD,
			U.REQ_CMD_ID,
			U.REQ_CMD
		FROM
			TB_DEV_SEP_INFO DSI 
		INNER JOIN 
			TB_SERV_URL_INFO U
		ON 
			DSI.SEP_CD = U.SEP_CD 
        INNER JOIN 
            TB_RES_MAP_INFO RMI
        ON 
            DSI.SEP_CD = RMI.SEP_CD AND DSI.FLAG = #{flag} AND RMI.FLAG = #{flag} 
        INNER JOIN
            TB_DEV_CLI_MAP_INFO DCM 
        ON 
            RMI.DEV_CD = DCM.DEV_CD AND DCM.FLAG = #{flag}  
		WHERE 
			DSI.VENDER_CD = #{vendor_code} AND 
			DSI.MODEL_NO = #{model} AND  
			DSI.DEV_TYPE = #{type} AND  
			DCM.SERVICE_ID = #{service_id} AND
			U.REQ_STATUS = #{reqStatus}
	</select>
	
	<select id="selectStatusDBReqInfo" parameterType = "hashmap" resultType="hashmap">
		SELECT 
			U.HTTP_METHOD, 
			U.HEADER_V, 
			U.CONT_TYPE, 
			U.CHANNEL_CD, 
			U.SERVICE_CD,
			U.REQ_CMD_ID,
			U.REQ_CMD
		FROM
			TB_DEV_SEP_INFO DS 
		INNER JOIN 
			TB_SERV_URL_INFO U
		ON 
			DS.SEP_CD = U.SEP_CD AND DS.FLAG = #{flag} AND U.FLAG = #{flag} 
		WHERE 
			DS.VENDER_CD = #{vendor_code} AND 
			DS.MODEL_NO = #{model} AND  
			DS.DEV_TYPE= #{type} AND  
			U.REQ_STATUS = #{reqStatus}
	</select>
	
	<select id="selectMappingData" parameterType="hashmap" resultType="hashmap">
	
		SELECT
			RMI.RES_CMD,
			RMI.DEV_KEY,
			RMI.DEV_STATUS,
			DCM.DEV_TYPE AS CLI_DEV_TYPE,
			DCM.DEV_KEY AS CLI_DEV_KEY,
			DCM.DEV_STATUS AS CLI_DEV_STATUS,
			DCM.TEMP_FLAG  
		FROM 
			TB_DEV_CLI_MAP_INFO DCM 
		INNER JOIN 
			TB_RES_MAP_INFO RMI
		ON 
			RMI.DEV_CD = DCM.DEV_CD AND RMI.FLAG = #{flag} AND DCM.FLAG = #{flag} 
		INNER JOIN 
			TB_DEV_SEP_INFO DSI 
		ON 
			DSI.SEP_CD = RMI.SEP_CD AND DSI.FLAG = #{flag} 
		WHERE 
			DSI.VENDER_CD= #{vendor_code} AND 
			DSI.MODEL_NO= #{model} AND 
			DSI.DEV_TYPE= #{type} AND 
			DCM.SERVICE_ID = #{service_id}
	</select>

</mapper>